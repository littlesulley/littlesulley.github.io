<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.1.0">

<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/radahn-medium.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/radahn-medium.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/radahn-small.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="baidu-site-verification" content="code-2oysa9iikh">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,300italic,400,400italic,700,700italic%7CNoto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/black/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"sulley.cc","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.10.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":null,"activeClass":"disqus"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":3,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="The camera system inside Unreal Engine provides very basic functions. It merely enables the camera to follow a target with limited adjustable paramters such as offset, camera distance, lag, etc. We">
<meta property="og:type" content="article">
<meta property="og:title" content="Implementing A Minimum 1V1 Camera in UE (akin to FramingTransposer + Composer in Cinemachine)">
<meta property="og:url" content="http://sulley.cc/2022/12/11/09/16/index.html">
<meta property="og:site_name" content="Sulley">
<meta property="og:description" content="The camera system inside Unreal Engine provides very basic functions. It merely enables the camera to follow a target with limited adjustable paramters such as offset, camera distance, lag, etc. We">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://sulley.cc/images/1v1camera/1.png">
<meta property="article:published_time" content="2022-12-11T01:16:34.000Z">
<meta property="article:modified_time" content="2022-12-14T17:32:54.310Z">
<meta property="article:author" content="Sulley">
<meta property="article:tag" content="数学">
<meta property="article:tag" content="随笔">
<meta property="article:tag" content="计算机">
<meta property="article:tag" content="UE">
<meta property="article:tag" content="相机">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://sulley.cc/images/1v1camera/1.png">


<link rel="canonical" href="http://sulley.cc/2022/12/11/09/16/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://sulley.cc/2022/12/11/09/16/","path":"2022/12/11/09/16/","title":"Implementing A Minimum 1V1 Camera in UE (akin to FramingTransposer + Composer in Cinemachine)"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Implementing A Minimum 1V1 Camera in UE (akin to FramingTransposer + Composer in Cinemachine) | Sulley</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Sulley</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Betray Yourself.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">21</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">11</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">27</span></a></li>
        
            
  <li class="menu-item menu-item-相册"><a href="/photos/" rel="section"><i class="fa fa-camera fa-fw"></i>相册</a></li>


      
        <li class="menu-item menu-item-资源"><a href="/resources/" rel="section"><i class="fa fa-book fa-fw"></i>资源</a></li>
        <li class="menu-item menu-item-留言"><a href="/comments/" rel="section"><i class="fa fa-comment fa-fw"></i>留言</a></li>
        <li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#start-with-a-simple-case-mathematical-derivation-for-camera-location-and-rotation"><span class="nav-number">1.</span> <span class="nav-text">Start
with A Simple Case: Mathematical Derivation for Camera Location and
Rotation</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#constructing-the-equation"><span class="nav-number">1.1.</span> <span class="nav-text">Constructing the equation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#determining-mathbft_1"><span class="nav-number">1.2.</span> <span class="nav-text">Determining \(\mathbf{t}_1\)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#determining-varphi-and-theta"><span class="nav-number">1.3.</span> <span class="nav-text">Determining \(\varphi\) and \(\theta\)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#final-camera-location-and-rotation-and-blueprint-implementation"><span class="nav-number">1.4.</span> <span class="nav-text">Final
camera location and rotation and blueprint implementation</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Sulley"
      src="/images/radahn-avatar.png">
  <p class="site-author-name" itemprop="name">Sulley</p>
  <div class="site-description" itemprop="description">珍惜眼前人</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/littlesulley" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;littlesulley" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:qinghonghan97@gmail.com" title="E-Mail → mailto:qinghonghan97@gmail.com" rel="noopener" target="_blank"><i class="fa-solid fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/1631723" title="Bilibili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;1631723" rel="noopener" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://steamcommunity.com/id/beingaway/" title="Steam → https:&#x2F;&#x2F;steamcommunity.com&#x2F;id&#x2F;beingaway&#x2F;" rel="noopener" target="_blank"><i class="fab fa-steam fa-fw"></i>Steam</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/han-qing-hong-33" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;han-qing-hong-33" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>Zhihu</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://kungtalon.github.io/" title="https:&#x2F;&#x2F;kungtalon.github.io&#x2F;" rel="noopener" target="_blank">Kungtalon</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://kaesenudeln.github.io/" title="https:&#x2F;&#x2F;kaesenudeln.github.io&#x2F;" rel="noopener" target="_blank">Zecx</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://sulley.cc/2022/12/11/09/16/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/radahn-avatar.png">
      <meta itemprop="name" content="Sulley">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sulley">
      <meta itemprop="description" content="珍惜眼前人">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Implementing A Minimum 1V1 Camera in UE (akin to FramingTransposer + Composer in Cinemachine) | Sulley">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Implementing A Minimum 1V1 Camera in UE (akin to FramingTransposer + Composer in Cinemachine)
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-12-11 09:16:34" itemprop="dateCreated datePublished" datetime="2022-12-11T09:16:34+08:00">2022-12-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-12-15 01:32:54" itemprop="dateModified" datetime="2022-12-15T01:32:54+08:00">2022-12-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%B8%B8%E6%88%8F-%E7%9B%B8%E6%9C%BA/" itemprop="url" rel="index"><span itemprop="name">游戏 - 相机</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2022/12/11/09/16/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2022/12/11/09/16/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>7 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>The camera system inside Unreal Engine provides very basic functions.
It merely enables the camera to follow a target with limited adjustable
paramters such as offset, camera distance, lag, etc. We would like a
more powerful camera system, like the Cinemachine toolset in Unity, to
facilitate creating more interesting and compelling visual experience
for gameplay. In most 3D adventure games, a 1v1 camera is required when
you fight with a BOSS and you need to look at the BOSS however you move
and cast skills. Unfortunately, 1v1 camera is not a built-in function in
UE, so we have to implement our own version of 1v1 camera.</p>
<p>In this post, I will share with you how to implement a minimum 1v1
camera in UE using only blueprints, based on some simple mathematics. If
you are more familiar with coding, you can also implement this 1v1
camera with only few lines of code.</p>
<span id="more"></span>
<h1
id="start-with-a-simple-case-mathematical-derivation-for-camera-location-and-rotation">Start
with A Simple Case: Mathematical Derivation for Camera Location and
Rotation</h1>
<h2 id="constructing-the-equation">Constructing the equation</h2>
<p>The most crucial two parts of any camera behavior are the
<strong>location</strong> and <strong>rotation</strong>, the former
determines where the camera is and the latter controls where the camera
looks at.</p>
<p>Let us first begin with a simple case: assume the follow location is
<span class="math inline">\(\mathbf{a}\)</span>, the look-at location is
<span class="math inline">\(\mathbf{b}\)</span>, and the look-at point
is fixed at the center of the screen. We introduce a
<code>Follow Screen X</code> parameter (denoted by <span
class="math inline">\(a_x\)</span>) controlling the relative x-axis
offset of the follow point on the screen space. If <span
class="math inline">\(a_x=0\)</span>, the follow point will be on the
center of the screen; if <span class="math inline">\(a_x=0.5\)</span>,
the follow point will be on the rightmost position of the screen; if
<span class="math inline">\(a_x=-0.5\)</span>, it will be on the
leftmost position of the screen. At this stage, we do not take
<code>Follow Screen Y</code> into consideration for simplication.</p>
<p>To determine camera location and rotation, consider a sphere centered
at the origin. Assume camera distance (the distance of the camera to the
follow point) is <span class="math inline">\(r\)</span>, pitch angle
<span class="math inline">\(\varphi\in[-\pi/2,\pi/2]\)</span>, yaw angle
<span class="math inline">\(\theta\in[-\pi,\pi]\)</span>, we can write
down the camera location before applying the follow point offset:</p>
<p><span class="math display">\[
\begin{equation}
\mathbf{x}=\begin{pmatrix}
r\cos\varphi\cos\theta\\
r\cos\varphi\sin\theta\\
r\sin\varphi
\end{pmatrix}
\label{x}
\end{equation}
\]</span></p>
<p>Note that <span class="math inline">\(\eqref{x}\)</span> is the
<strong>raw camera location</strong> relative to the origin. The look-at
direction, however, is <span
class="math inline">\(-\mathbf{x}/r\)</span>, and the <strong>actual
camera location</strong> is <span
class="math inline">\(\mathbf{a}+\mathbf{x}\)</span>. For integrating
<span class="math inline">\(a_x\)</span>, we can assume the camera
offset is <span class="math inline">\(\mathbf{t}_1\)</span>, hence, the
<strong>final camera location</strong> is <span
class="math inline">\(\mathbf{a}+\mathbf{x}+\mathbf{t}_1\)</span>, and
the look-at direction from camera to <span
class="math inline">\(\mathbf{b}\)</span> is <span
class="math inline">\(\mathbf{b}-(\mathbf{a}+\mathbf{x}+\mathbf{t}_1)\)</span>.
Because <span class="math inline">\(\mathbf{t}_1\)</span> does not
change the orientation of camera, the camera's look-at direction, as we
have stated above, is still <span
class="math inline">\(-\mathbf{x}/r\)</span>. It is obvious that we have
the following equation:</p>
<p><span class="math display">\[
\begin{equation}
    \mathbf{b}-\mathbf{a}-\mathbf{x}-\mathbf{t}_1=-k\mathbf{x}
\label{main}
\end{equation}
\]</span></p>
<p>where <span class="math inline">\(k\)</span> is an unknown
coefficient satisfying <span class="math inline">\(k&gt;0\)</span>.
Before wo go ahead solving this equation, we should determine <span
class="math inline">\(\mathbf{t}_1\)</span> at the first place.</p>
<h2 id="determining-mathbft_1">Determining <span
class="math inline">\(\mathbf{t}_1\)</span></h2>
<p>We can easily express <span
class="math inline">\(\mathbf{t}_1\)</span> in terms of <span
class="math inline">\(a_x, r\)</span> and the field of view of the
camera. As shown in the following figure, we have:</p>
<p><span class="math display">\[
\begin{equation}
    \frac{N}{r}=\tan\left(\frac{\text{fov}}{2}\right)\Rightarrow
N=r\tan\left(\frac{\text{fov}}{2}\right)
\label{N}
\end{equation}
\]</span></p>
<p>where <span class="math inline">\(N\)</span> is the world-space
length of half screen. Then, the offset amount is <span
class="math inline">\(2a_xN\)</span> (note that when <span
class="math inline">\(a_x=0.5\)</span>, the offset amount will be <span
class="math inline">\(N\)</span>), and the offset direction will be the
opposite of the sign of <span class="math inline">\(a_x\)</span>. That
is, is <span class="math inline">\(a_x&gt;0\)</span>, camera will
translate left, otherwise it will translate right.</p>
<p><img data-src="/images/1v1camera/1.png" /></p>
<p>Plug <span class="math inline">\(\eqref{N}\)</span> into <span
class="math inline">\(-2x_aN\)</span>, the directional offset magnitude
will be <span
class="math inline">\(-2a_xr\tan\left(\frac{\text{fov}}{2}\right)\)</span>.</p>
<p>A remaining question is which unit vector this offset will be applied
along? The answer is the camera's local right direction. It can be
readily computed by taking the cross product between camera's local unit
forward vector <span class="math inline">\(-\mathbf{x}/r\)</span> and
world space up vector <span
class="math inline">\((0,0,1)^\top\)</span>:</p>
<p><span class="math display">\[
\begin{equation}
    \begin{pmatrix}
    -\cos\varphi\cos\theta\\
    -\cos\varphi\sin\theta\\
    -\sin\varphi
    \end{pmatrix}\times
    \begin{pmatrix}
    0\\
    0\\
    1
    \end{pmatrix}=
    \begin{pmatrix}
    -\cos\varphi\sin\theta\\
    \cos\varphi\cos\theta\\
    0
    \end{pmatrix}
\end{equation}
\]</span></p>
<p>Normalizing the result, and considering that UE's coordiante system
is based on the left-hand rule, the local unit right vector will be
<span class="math inline">\((\sin\theta, -\cos\theta, 0)^\top\)</span>.
Thus, the consequent offset vector is:</p>
<p><span class="math display">\[
\begin{equation}
    \mathbf{t}_1=t_1\begin{pmatrix}
    \sin\theta\\
    -\cos\theta\\
    0
    \end{pmatrix},~~t_1=-2a_xr\tan\left(\frac{\text{fov}}{2}\right)
\end{equation}
\]</span></p>
<h2 id="determining-varphi-and-theta">Determining <span
class="math inline">\(\varphi\)</span> and <span
class="math inline">\(\theta\)</span></h2>
<p>With <span class="math inline">\(\mathbf{t}_1\)</span>, we can now
determine <span class="math inline">\(\varphi\)</span> and <span
class="math inline">\(\theta\)</span>. Expanding <span
class="math inline">\(\eqref{main}\)</span>, we have:</p>
<p><span class="math display">\[
\begin{equation}
    \begin{pmatrix}
    x_B\\
    y_B\\
    z_B
    \end{pmatrix}-
    \begin{pmatrix}
    x_A\\
    y_A\\
    z_A
    \end{pmatrix}-
    \begin{pmatrix}
    r\cos\varphi\cos\theta\\
    r\cos\varphi\sin\theta\\
    r\sin\varphi
    \end{pmatrix}-
    \begin{pmatrix}
    t_1\sin\theta\\
    -t_1\cos\theta\\
    0
    \end{pmatrix}=-k\begin{pmatrix}
    r\cos\varphi\cos\theta\\
    r\cos\varphi\sin\theta\\
    r\sin\varphi
    \end{pmatrix}
\label{eq6}
\end{equation}
\]</span></p>
<p>Simplifying <span class="math inline">\(\eqref{eq6}\)</span>, we
have:</p>
<p><span class="math display">\[
\begin{pmatrix}
\Delta x\\
\Delta y\\
\Delta z
\end{pmatrix}=
\begin{pmatrix}
    (1-k)r\cos\varphi\cos\theta+t_1\sin\theta\\
    (1-k)r\cos\varphi\sin\theta-t_1\cos\theta\\
    (1-k)r\sin\varphi
\end{pmatrix}
\]</span></p>
<p>which leads to three equations:</p>
<p><span class="math display">\[
\begin{align}
    (1-k)r\cos\varphi\cos\theta+t_1\sin\theta &amp;= \Delta x
\label{eq7}\\
    (1-k)r\cos\varphi\sin\theta-t_1\cos\theta &amp;= \Delta y
\label{eq8}\\
    (1-k)r\sin\varphi &amp;= \Delta z \label{eq9}
\end{align}
\]</span></p>
<p>Rewrite <span class="math inline">\(\eqref{eq9}\)</span>, we
have:</p>
<p><span class="math display">\[
\begin{equation}
    (1-k)r=\frac{\Delta z}{\sin\varphi}
    \label{eq10}
\end{equation}
\]</span></p>
<p>Plug <span class="math inline">\(\eqref{eq10}\)</span> into <span
class="math inline">\(\eqref{eq7}\)</span> and <span
class="math inline">\(\eqref{eq8}\)</span>:</p>
<p><span class="math display">\[
\begin{align}
    \frac{\Delta z}{\tan\varphi}\cos\theta+t_1\sin\theta &amp;= \Delta x
\label{eq11}\\
    \frac{\Delta z}{\tan\varphi}\sin\theta-t_1\cos\theta &amp;= \Delta y
\label{eq12}\\
\end{align}
\]</span></p>
<p>Combining <span class="math inline">\(\eqref{eq11}\)</span> and <span
class="math inline">\(\eqref{eq12}\)</span>, we have:</p>
<p><span class="math display">\[
\begin{equation}
    \frac{\Delta x - t_1\sin\theta}{\cos\theta}=\frac{\Delta y
+t_1\cos\theta}{\sin\theta}\Rightarrow \Delta x\sin\theta-\Delta
y\cos\theta=t_1
\label{eq13}
\end{equation}
\]</span></p>
<p>To note, when <span class="math inline">\(\theta=0\)</span> or <span
class="math inline">\(\theta=\pi\)</span>, the above equation also
holds. Divided by <span class="math inline">\(\sqrt{(\Delta x)^2+(\Delta
y)^2}\)</span> on both sides, we have:</p>
<p><span class="math display">\[
\small
\begin{equation}
\begin{aligned}
    \frac{t_1}{\sqrt{(\Delta x)^2+(\Delta y)^2}} &amp;= \frac{\Delta
x}{\sqrt{(\Delta x)^2+(\Delta y)^2}}\sin\theta-\frac{\Delta
y}{\sqrt{(\Delta x)^2+(\Delta y)^2}}\cos\theta\\
    \frac{t_1}{\sqrt{(\Delta x)^2+(\Delta y)^2}} &amp;=
\cos\alpha\sin\theta-\sin\alpha\cos\theta \\
    \frac{t_1}{\sqrt{(\Delta x)^2+(\Delta y)^2}} &amp;=
\sin(\theta-\alpha) \\
    \theta &amp;= \alpha + \arcsin\left(\frac{t_1}{\sqrt{(\Delta
x)^2+(\Delta y)^2}}\right)\\
    \theta &amp;= {\color{cyan}\arcsin\left(\frac{\Delta
y}{\sqrt{(\Delta x)^2+(\Delta y)^2}}\right)}+
\arcsin\left(\frac{t_1}{\sqrt{(\Delta x)^2+(\Delta y)^2}}\right)
\end{aligned}
\label{eq14}
\end{equation}
\]</span></p>
<p>It's particularly noteworthy that the tinted part should be modified
according to the sign of <span class="math inline">\(\Delta x\)</span>
and <span class="math inline">\(\Delta y\)</span>. A simple observation
is:</p>
<ul>
<li><span class="math inline">\(\Delta x&gt;0\)</span> and <span
class="math inline">\(\Delta y&gt;0\)</span>, <span
class="math inline">\(\theta\in[-\pi,-\pi/2]\)</span></li>
<li><span class="math inline">\(\Delta x&gt;0\)</span> and <span
class="math inline">\(\Delta y&lt;0\)</span>, <span
class="math inline">\(\theta\in[\pi/2,\pi]\)</span></li>
<li><span class="math inline">\(\Delta x&lt;0\)</span> and <span
class="math inline">\(\Delta y&gt;0\)</span>, <span
class="math inline">\(\theta\in[-\pi/2,0]\)</span></li>
<li><span class="math inline">\(\Delta x&lt;0\)</span> and <span
class="math inline">\(\Delta y&gt;0\)</span>, <span
class="math inline">\(\theta\in[0,\pi/2]\)</span></li>
</ul>
<p>The value returned by <span
class="math inline">\(\arcsin(\cdot)\)</span> lies within <span
class="math inline">\([-\pi/2,\pi/2]\)</span> should be further altered
according to the observation above. It can be easily concluded that
(assume the raw returned value is <span
class="math inline">\(\hat{\alpha}\)</span>):</p>
<p><span class="math display">\[
\begin{equation}
    \alpha=\begin{cases}
        \hat{\alpha}-\pi,~&amp;\Delta x&gt;0\\
        -\hat{\alpha},~&amp;\Delta x\le 0
    \end{cases}
\end{equation}
\]</span></p>
<p>The second problem, which is very palpable, is that <span
class="math inline">\(\frac{t_1}{\sqrt{(\Delta x)^2+(\Delta
y)^2}}\)</span> can be smaller than <span
class="math inline">\(-1\)</span> or larger than <span
class="math inline">\(1\)</span>, when the denominator is small. If this
value exceeds the bound and we clip it, the resulting yaw <span
class="math inline">\(\theta\)</span> and the subsequent pitch <span
class="math inline">\(\varphi\)</span> would be incorrect, making odd
camera artifacts.</p>
<p>Here are several potential workarounds to deal with this issue:</p>
<ul>
<li></li>
</ul>
<p>Here we leave out the case when <span class="math inline">\(\Delta
x=\Delta y =0\)</span> since usually the player character and the enemy
will not be on the up axis at the same time.</p>
<p>Once we have <span class="math inline">\(\theta\)</span>, we can
easily find out <span class="math inline">\(\varphi\)</span>. By <span
class="math inline">\(\eqref{eq11}\)</span> (or <span
class="math inline">\(\eqref{eq12}\)</span> equivalently), we have:</p>
<p><span class="math display">\[
\begin{equation}
    \varphi=\arctan\left(\frac{\Delta z\cos\theta}{\Delta
x-t_1\sin\theta}\right)
\label{eq16}
\end{equation}
\]</span></p>
<h2
id="final-camera-location-and-rotation-and-blueprint-implementation">Final
camera location and rotation and blueprint implementation</h2>
<p>Eventually, we can compute the camera location and rotation. Location
is <span
class="math inline">\(\mathbf{x}+\mathbf{a}+\mathbf{t}_1\)</span>, and
rotation can be set to look at <span
class="math inline">\(\mathbf{b}\)</span>.</p>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
        <div class="popular-posts-date">2021-06-07</div>
      <div class="popular-posts-title"><a href="/2021/06/07/08/38/" rel="bookmark">向量绕任意轴旋转的简单推导</a></div>
        <div class="popular-posts-excerpt"><p><p>图形学中有关旋转的一个问题是，一个（三维空间的）向量绕一个任意轴旋转若干角度后的角度是什么。本文简单进行推导，给出显式结果。</p></p></div>
    </li>
    <li class="popular-posts-item">
        <div class="popular-posts-date">2022-03-25</div>
      <div class="popular-posts-title"><a href="/2022/03/25/01/00/" rel="bookmark">四元数与旋转</a></div>
        <div class="popular-posts-excerpt"><p><p>图形学中的旋转（Rotation）非常重要，用欧拉角（Euler
Angle）旋转非常简单，但是却存在 <strong>万向锁（Gimbal Lock）</strong>
的问题；同时，用欧拉角插值也不尽方便。基于四元数（Quaternion）的旋转既解决了万向锁的问题，又能非常便利地插值。本文将从概念出发，对四元数的定义、推导、性质、应用，以及它与欧拉角之间的联系进行介绍。本文主要参考了Krasjet的《四元数与三维旋转》<a
href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a>，其他参考内容包括<a href="#fn2"
class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a><a
href="#fn3" class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a><a href="#fn4" class="footnote-ref"
id="fnref4" role="doc-noteref"><sup>4</sup></a><a href="#fn5"
class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a><a
href="#fn6" class="footnote-ref" id="fnref6"
role="doc-noteref"><sup>6</sup></a><a href="#fn7" class="footnote-ref"
id="fnref7" role="doc-noteref"><sup>7</sup></a><a href="#fn8"
class="footnote-ref" id="fnref8"
role="doc-noteref"><sup>8</sup></a>。</p></p></div>
    </li>
    <li class="popular-posts-item">
        <div class="popular-posts-date">2022-10-12</div>
      <div class="popular-posts-title"><a href="/2022/10/12/18/39/" rel="bookmark">Bump Mapping, Normal Mapping and Displacement Mapping</a></div>
        <div class="popular-posts-excerpt"><p><p>凹凸贴图（Bump
mapping）是图形学中一种常用的用于改变物体视觉凹凸性的方法，但是网上很多介绍对它的原理和变体都非常模糊，甚至包含一些关键概念的错误。本文将详细介绍凹凸贴图及其变体（Normal
Mapping和Displacement
Mapping）的原理，并在代码上加以实现，以便让读者更好地理解这项技术。</p></p></div>
    </li>
    <li class="popular-posts-item">
        <div class="popular-posts-date">2022-06-26</div>
      <div class="popular-posts-title"><a href="/2022/06/26/23/03/" rel="bookmark">用生成函数和复数巧解一道计数题</a></div>
        <div class="popular-posts-excerpt"><p><p>对集合<span
class="math inline">\(\{1,2,\cdots,2000\}\)</span>，求出其中有多少子集，使得子集中的元素和为5的倍数。本文对<a
target="_blank" rel="noopener" href="https://youtu.be/bOXCLR3Wric">3Blue3Brown的解法</a>上进行总结，形成较为数学化的语言。本题背后有较为深刻的数学思想，故记载于此。</p></p></div>
    </li>
    <li class="popular-posts-item">
        <div class="popular-posts-date">2022-10-08</div>
      <div class="popular-posts-title"><a href="/2022/10/08/11/01/" rel="bookmark">GAMES101疑难点及作业详解</a></div>
        <div class="popular-posts-excerpt"><p><p>很早之前就想跟着做完GAMES101，但是拖延症一直让我拖到了现在，我决定不再鸽下去！本篇Blog主要记录在GAMES101学习中遇到的疑难问题，整理Bonus
Material，以及详解每一课的作业（含提高题）。如有任何错误、遗漏，欢迎读者指出赐教！</p></p></div>
    </li>
  </ul>


    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>原作者： </strong>Sulley
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://sulley.cc/2022/12/11/09/16/" title="Implementing A Minimum 1V1 Camera in UE (akin to FramingTransposer + Composer in Cinemachine)">http://sulley.cc/2022/12/11/09/16/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag"># 数学</a>
              <a href="/tags/%E9%9A%8F%E7%AC%94/" rel="tag"># 随笔</a>
              <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" rel="tag"># 计算机</a>
              <a href="/tags/UE/" rel="tag"># UE</a>
              <a href="/tags/%E7%9B%B8%E6%9C%BA/" rel="tag"># 相机</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/11/21/16/03/" rel="prev" title="A Brief Note on Version Control and Project Organization">
                  <i class="fa fa-chevron-left"></i> A Brief Note on Version Control and Project Organization
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sulley</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">312k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">4:44</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.2.7/pdfobject.min.js","integrity":"sha256-ph3Dk89VmuTVXG6x/RDzk53SU9LPdAh1tpv0UvnDZ2I="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>


  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>

  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"littlesulley","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
